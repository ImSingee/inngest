package tracing

import (
	"github.com/inngest/inngest/pkg/execution/state"
	"go.opentelemetry.io/otel/attribute"
	"go.opentelemetry.io/otel/trace"
)

func extractRunID(attrs []attribute.KeyValue) string {
	for _, attr := range attrs {
		if string(attr.Key) == AttributeRunID {
			return attr.Value.AsString()
		}
	}
	return ""
}

// ApplyResponseToSpan applies details from the given `DriverResponse` to the
// given span. This is used for adding additional details to the span after the
// exectution has completed.
func ApplyResponseToSpan(span trace.Span, resp *state.DriverResponse) {
	if resp.IsDiscoveryResponse() {
		// We ignore discovery responses and rely on other spans to show steps
		// generated by handling opcodes later on.
		span.SetAttributes(attribute.Bool(AttributeDropSpan, true))
		return
	}

	// TODO
}
